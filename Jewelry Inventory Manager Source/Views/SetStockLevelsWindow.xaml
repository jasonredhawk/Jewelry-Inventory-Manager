<Window x:Class="Moonglow_DB.Views.SetStockLevelsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Controls="clr-namespace:Moonglow_DB.Views.Controls"
        Title="Set Stock Levels" Height="1100" Width="1200"
        WindowStartupLocation="CenterOwner"
        MinHeight="1100" MinWidth="1200"
        Background="#F5F5F5">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Styles/SharedStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2196F3" Padding="15">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="📊" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Text="Set Stock Levels" 
                           FontSize="20" 
                           FontWeight="Bold" 
                           Foreground="White" 
                           VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Information Panel -->
        <Border Grid.Row="1" Background="#E3F2FD" Padding="15" Margin="20,10,20,0" BorderBrush="#2196F3" BorderThickness="1" CornerRadius="5">
            <StackPanel>
                <TextBlock Text="ℹ️ Stock Level Management" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                <TextBlock TextWrapping="Wrap" FontSize="12" LineHeight="16">
                    <Run Text="• "/><Run Text="Minimum Stock" FontWeight="Bold"/>: The lowest quantity you want to maintain. When stock falls below this level, items appear in low stock alerts.
                    <LineBreak/>
                    <Run Text="• "/><Run Text="Full Stock" FontWeight="Bold"/>: The target quantity you want to maintain. When generating POs, the system orders enough to reach this level.
                    <LineBreak/>
                    <Run Text="• "/><Run Text="Current Stock" FontWeight="Bold"/>: The actual quantity available at the selected location.
                </TextBlock>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Filters and Quick Edit -->
            <StackPanel Grid.Column="0" Margin="0,0,20,0">
                
                <!-- Location Selection -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                    <TextBlock Text="Location:" VerticalAlignment="Center" Width="100" FontWeight="Bold"/>
                    <ComboBox x:Name="cmbLocation" Width="180" Height="30" SelectionChanged="cmbLocation_SelectionChanged"/>
                </StackPanel>

                                 <!-- Item Type Selection -->
                 <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                     <TextBlock Text="Item Type:" VerticalAlignment="Center" Width="100" FontWeight="Bold"/>
                     <ComboBox x:Name="cmbItemType" Width="180" Height="30" SelectionChanged="cmbItemType_SelectionChanged">
                         <ComboBoxItem Content="Product &amp; Component" IsSelected="True"/>
                         <ComboBoxItem Content="Product"/>
                         <ComboBoxItem Content="Component"/>
                     </ComboBox>
                 </StackPanel>

                 <!-- Category Selection -->
                 <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                     <TextBlock Text="Category:" VerticalAlignment="Center" Width="100" FontWeight="Bold"/>
                     <ComboBox x:Name="cmbCategory" Width="180" Height="30" SelectionChanged="cmbCategory_SelectionChanged"/>
                 </StackPanel>

                <!-- Selected Item Info -->
                <Border Background="White" Padding="15" Margin="0,15,0,15" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="Selected Item Information" FontWeight="Bold" Margin="0,0,0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Item Name:" FontWeight="SemiBold" Margin="0,0,10,5"/>
                            <TextBlock x:Name="txtItemName" Grid.Row="0" Grid.Column="1" Text="" Margin="0,0,0,5"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Current Stock:" FontWeight="SemiBold" Margin="0,0,10,5"/>
                            <TextBlock x:Name="txtCurrentStock" Grid.Row="1" Grid.Column="1" Text="0" Margin="0,0,0,5"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Min Stock:" FontWeight="SemiBold" Margin="0,0,10,5"/>
                            <TextBlock x:Name="txtCurrentMinStock" Grid.Row="2" Grid.Column="1" Text="0" Margin="0,0,0,5"/>
                            
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Full Stock:" FontWeight="SemiBold" Margin="0,0,10,5"/>
                            <TextBlock x:Name="txtCurrentFullStock" Grid.Row="3" Grid.Column="1" Text="0" Margin="0,0,0,5"/>
                        </Grid>
                    </StackPanel>
                </Border>

                                 <!-- Quick Edit Section -->
                 <Border Background="#F8F9FA" Padding="15" Margin="0,0,0,25" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="Quick Edit" FontWeight="Bold" Margin="0,0,0,10"/>
                        
                                                 <!-- Minimum Stock Input -->
                         <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                             <TextBlock Text="Min Stock:" VerticalAlignment="Center" Width="80" FontWeight="Bold"/>
                             <TextBox x:Name="txtNewMinStock" Width="80" Height="35" Style="{StaticResource ModernTextBoxStyle}" PreviewTextInput="txtNewMinStock_PreviewTextInput"/>
                             <TextBlock Text="(0 = remove)" VerticalAlignment="Center" Margin="5,0,0,0" Foreground="#666" FontSize="11"/>
                         </StackPanel>

                         <!-- Full Stock Input -->
                         <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                            <TextBlock Text="Full Stock:" VerticalAlignment="Center" Width="80" FontWeight="Bold"/>
                            <TextBox x:Name="txtNewFullStock" Width="80" Height="35" Style="{StaticResource ModernTextBoxStyle}" PreviewTextInput="txtNewFullStock_PreviewTextInput"/>
                        </StackPanel>

                        <!-- Save Button -->
                        <Button x:Name="btnSaveStock" 
                                Content="💾 Save Changes" 
                                Style="{StaticResource SuccessButtonStyle}"
                                Click="btnSaveStock_Click"
                                Width="150" Height="30"/>
                    </StackPanel>
                </Border>

            </StackPanel>

            <!-- Right Panel - Comprehensive Grid -->
            <Border Grid.Column="1" Background="White" Padding="15" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="5">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="📋 All Items - Stock Levels" FontWeight="Bold" FontSize="16"/>
                        <TextBlock x:Name="txtItemCount" Text="" Margin="10,0,0,0" VerticalAlignment="Center" Foreground="#666"/>
                    </StackPanel>
                    
                                         <DataGrid x:Name="dgStockItems" 
                               Height="750"
                               AutoGenerateColumns="False" 
                               CanUserAddRows="False"
                               IsReadOnly="True"
                               SelectionMode="Single"
                               SelectionChanged="dgStockItems_SelectionChanged"
                               GridLinesVisibility="Horizontal"
                               HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Type" Binding="{Binding ItemType}" Width="70"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200"/>
                            <DataGridTextColumn Header="SKU" Binding="{Binding SKU}" Width="80"/>
                            <DataGridTextColumn Header="Location" Binding="{Binding LocationName}" Width="100"/>
                            <DataGridTextColumn Header="Current" Binding="{Binding CurrentStock}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsLowStock}" Value="True">
                                                <Setter Property="Foreground" Value="Red"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                                                         <DataGridTextColumn Header="Min Stock" Binding="{Binding MinimumStock}" Width="80"/>
                             <DataGridTextColumn Header="Full Stock" Binding="{Binding FullStock}" Width="80"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding StockStatus}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding StockStatus}" Value="Low Stock">
                                                <Setter Property="Foreground" Value="Orange"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding StockStatus}" Value="Out of Stock">
                                                <Setter Property="Foreground" Value="Red"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding StockStatus}" Value="Well Stocked">
                                                <Setter Property="Foreground" Value="Green"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

        </Grid>

        <!-- Buttons -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="20">
            <Button x:Name="btnClose" 
                    Content="❌ Close" 
                    Style="{StaticResource DangerButtonStyle}"
                    Click="btnClose_Click"
                    Width="100" Height="35"/>
        </StackPanel>
    </Grid>
</Window> 